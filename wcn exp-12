% Parameters 
Fs = 1000;              
Ts = 1/Fs;               
t = 0:Ts:1-Ts;         
f = 5;                      
% Sampling frequency 
% Sampling period 
% Time vector 
% Frequency of the input signal 
input_signal = sin(2*pi*f*t); % Input signal 
% Add noise  
noise = 0.5*randn(size(t)); 
received_signal = input_signal + noise; % Received signal 
% Adaptive Equalizer parameters 
M = 5;
 mu = 0.01;
                  % Number of taps 
             % Step size 
weights = zeros(1, M); % Initialize weights 
output_signal = zeros(1, length(received_signal)); 
% Adaptive filtering 
for n = M:length(received_signal) 
x = received_signal(n:-1:n-M+1); % Input vector 
output_signal(n) = weights * x';  % Output signal 
error = input_signal(n) - output_signal(n); % Error signal 
weights = weights + mu * error * x; %  Update weights 
end 
% Plotting results 
figure; 
subplot(3,1,1); 
plot(t, input_signal); 
title('Input Signal'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
subplot(3,1,2); 
plot(t, received_signal); 
title('Received Signal with Noise'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
subplot(3,1,3); 
plot(t, output_signal); 
title('Output Signal after Equalization'); 
xlabel('Time (s)'); 
ylabel('Amplitude'); 
